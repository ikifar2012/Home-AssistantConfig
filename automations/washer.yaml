# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
#  Washing Machine Start/Finish
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- id: 'b44c34f2-cbc9-48dc-9979-b6e1adaeb1a2'
  alias: 'Washer State - Start'
  trigger:
    platform: numeric_state
    entity_id: sensor.washer_watts
    above: 5
    for:
      seconds: 4
# Make sure washer isn't already running and delaying between cycles - don't re-trigger and cause stopwatch reset
  condition:
    condition: template
    value_template: "{{ states.sensor.washer_state.state != 'Washing' }}"
  action:
    - service: mqtt.publish
      data_template:
        topic: hass/state/washer
        payload: 'Washing'
        retain: 'true'

- id: '27be766d-bcea-4f26-a554-3a04deef6d4a'
  alias: 'Washer State - Idle'
  trigger:
    platform: numeric_state
    entity_id: sensor.washer_watts
    below: 10
    for:
      minutes: 1
  action:
    - service: mqtt.publish
      data_template:
        topic: hass/state/washer
        payload: 'Idle'
        retain: 'true'

- id: '9b9a9d6a-ea59-4264-8503-7e8648f4ffeb'
  alias: 'Wash Done Say'
  trigger:
   - platform: state
     entity_id: sensor.washer_state
     from: 'Washing'
     to:  'Idle'
  action:
    - service: script.say_all
      data_template:
        message: "The Laundry is Done!"
    - service: notify.sandy
      data_template:
        message: "The Laundry is Done!"